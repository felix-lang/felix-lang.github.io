<html><head>
<style type="text/css">
body {margin:3%; }
h1 {color:gray; font-size:120%;}
h2 {color:gray; font-size:105%;}
h3 {font-size:100%;}
h4 {font-size:95%;}
h5 {font-size:95%;}
span.fstring {color:darkblue; font-style:italic; }
span.comment {font-family:arial; color:blue; font-style:italic; }
span.doccomment {font-family:arial; color:green; font-style:italic; }
span.big_keyword {color:#FF1010; }
span.small_keyword {color:#802040; }
span.qualifier {color:#A02020; }
span.library {color:#A02000; }
span.ctor {color:#406020; }
span.hack {color:#66DD00; }
span.preproc {color:#005500; }
span.embedded_c{background-color:#DDDDDD; }
span.fpc_fieldname {color:#DD0000; }
span.lineno {color:#101010; background-color:#E0E0E0; font-size:80%; font-family:"courier",monospace; font-style:normal; }
pre.flxbg {background-color:#A0FFA0; color:black; padding:2px; box-shadow:5px 5px 2px #807080; }
pre.uncheckedflxbg {background-color:#D0D0D0; color:black; padding:2px; box-shadow:5px 5px 2px #807080; }
pre.cppbg {background-color:#80FF80; color:black; }
pre.prefmtbg {background-color:#D0D0D0; color:black; }
pre.expected {background-color:#E0FF80; color:black; }
pre.input {background-color:#E08080; color:black; }
pre.inclusion {background-color:#D070D0; color:black; }
code.inclusion {background-color:#D070D0; color:black; }
.obsolete { background-color:#FFEFEF; font-size: small; color:black; }
.future { background-color:#FF8080; font-size: small; color:black; }
.implementation_detail { background-color:#E0E0E0; font-size: small; color:black;  }
.bug { background-color:#FFE0E0; font-size: small; color:black; }
.fixed{ background-color:#FFE0E0; font-size: small; color:black; }
.done { background-color:#FFE0E0; font-size: small; color:black; }
.caveat { background-color:#FF8080; color:black; }
</style>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
        skipTags: ["script","noscript","style","textarea"]
    }
  });
</script>
<title>Strings</title></head><body>
<style>
body {margin:3%; font-family: sans-serif; }
h1 {color:black; font-size:120%; border-bottom: 2px solid #ddd; padding: 0 0 3px 0;}
h2 {color:#202020; font-size:105%;}
h3 {font-size:100%;}
h4 {font-size:95%;}
h5 {font-size:95%;}
span.fstring {color:darkblue; font-style:italic; }
span.comment {font-family:arial; color:blue; font-style:italic; }
span.doccomment {font-family:arial; color:green; font-style:italic; }
span.big_keyword {color:#FF1010; }
span.small_keyword {color:#802040; }
span.qualifier {color:#A02020; }
span.library {color:#A02000; }
span.ctor {color:#406020; }
span.hack {color:#66DD00; }
span.preproc {color:#005500; }
span.embedded_c{background-color:#DDDDDD; }
span.fpc_fieldname {color:#DD0000; }
span.lineno {color:#101010; background-color:#E0E0E0; font-size:80%; font-family:"courier",monospace; font-style:normal; }
pre { border: 1px solid #ccc; color: black; box-shadow:3px 3px 2px rgba(0,0,0,0.1); padding:2px; }
pre.flxbg {background-color:#C2FDC2; box-shadow:3px 3px 2px rgba(0,0,0,0.1) }
pre.uncheckedflxbg {background-color:#eee; box-shadow:3px 3px 2px rgba(0,0,0,0.1); }
pre.cppbg {background-color:#C2FDC2; }
pre.prefmtbg {background-color:#F1F1F1; }
pre.expected {background-color:hsla(74,94%,88%,1); }
pre.input {background-color:hsla(20,94%,88%,1); }
pre.inclusion {
    font-family: Arial;
    font-weight: normal;
    font-size: 0.9em;
    color: #555;
    border: none;
    box-shadow: none;
    text-align: right;
    margin: -7px 11px -12px 0;
    padding: 0;
    background-color:#fafafa;
}
code.inclusion {background-color:#D070D0; color:black; }
.obsolete { background-color:#FFEFEF; font-size: small; color:black; }
.future { background-color:#FF8080; font-size: small; color:black; }
.implementation_detail { background-color:#E0E0E0; font-size: small; color:black;  }
.bug { background-color:#FFE0E0; font-size: small; color:black; }
.fixed{ background-color:#FFE0E0; font-size: small; color:black; }
.done { background-color:#FFE0E0; font-size: small; color:black; }
.caveat { background-color:hsla(0,100%,91%,1); color:black; padding: 0.6em; }
.container {
  position: fixed;
  top:0px;
  left:0px;
  height : 100%;
  width: 100%;
  background-color: grey;
  margin: 0px;
  padding: 0px;
  border-width: 0px;
  color: #404040;
}
.maincontent {
  padding:4px;
  padding-left:8px;
  line-height:1.3em;
  color:#404040; background-color:#fafafa;
}
.maincontent h1 { margin-left:-8px; position: relative; font-family: georgia, serif; font-size: 1.8em; font-weight: normal; }
.maincontent h2 { margin-left:-8px; position: relative; margin-bottom:-5px; }
.maincontent h3 { margin-left:-8px; position: relative; margin-bottom:-5px; }
.maincontent h4 { margin-left:-8px; position: relative; margin-bottom:-5px; }
.maincontent code { color:#902030; }
.toppanel {
  position:absolute; left:0px; top:0px; height:20px; right:0px;
  background-color: #e0e0e0;
}
.bottompanel {
  position:absolute; left:0px; top:22px; bottom:0px; right:0px;
  background-color: #fafafa;
  font-size:14px;
}
.leftpanel {
  position:absolute; left:0px; top:0px; bottom:0px; width: 150px;
  background-color: #eaeaea; overflow: auto;
}
.rightpanel {
  position:absolute; right: 0px; left:160px; top:0px; bottom: 0px;
  background-color: #fafafa; overflow: auto;
}
.divider {
  position:absolute; left: 150px; top:0px; bottom:0px;
  background-color: black; width:2px;
  box-shadow: 0 0 8px #000;
}

#panemover {
    position:absolute;
    left: 150px;
    width : 10px;
    top: 0px;
    bottom: 0px;
    opacity: 0.3;
    cursor:col-resize;
}

div.m {
    margin: 0px;
    padding:0px;
    border-width:2px;
    border-color: green;
}

div.m1 {
    background-color: #86E870;
    border-style:outset;
    border-color:#ccc;
    border-width:2px 0;
    font-size:90%;
    padding: 1px 0 2px 10px;
}

div.m2 {
    background-color: #70C070;
    padding-left:15px;
    padding-top:2px;
    border-style:outset;
    border-color:green;
    border-width:0 0 1px 0;
    font-size:80%;
}

div.m1:hover, div.m2:hover {
    background-color: white;
}

#leftmargintoc a {
    text-decoration: none;
    color: #404040;
}
</style>

<style>
div.m {
    margin: 0px;
    padding:0px;
    border-width:2px;
    border-color: green;
}

div.m1 {
    background-color: #86E870;
    border-style:outset;
    border-color:#ccc;
    border-width:2px 0;
    font-size:90%;
    padding: 1px 0 2px 10px;
}

div.m2 {
    background-color: #70C070;
    padding-left:15px;
    padding-top:2px;
    border-style:outset;
    border-color:green;
    border-width:0 0 1px 0;
    font-size:80%;
}

div.m1:hover, div.m2:hover {
    background-color: white;
}

#leftmargintoc a {
    text-decoration: none;
    color: #404040;
}


</style>

    <script async="true">
      function dragStart(e, left, right){
        document.getElementById("panemover").style.width="70%";
        document.getElementById("panemover").style.left="50px";
        mousedown = true;
        x = e.clientX
        dragOffsetLeft =
          document.getElementById(left).getBoundingClientRect().right -
          document.getElementById(left).getBoundingClientRect().left -
          x
        ;
        dragOffsetDivider= document.getElementById("divider").getBoundingClientRect().left - x;
        dragOffsetRight = document.getElementById(right).getBoundingClientRect().left - x;
      }
      function dragRelease(){
        document.getElementById('panemover').style.width = '10px';
        document.getElementById('panemover').style.left = document.getElementById('divider').offsetLeft + 'px';
        mousedown = false;
      }
      function drag(e, left, right){
        if(!mousedown){return}
        x = e.clientX
        tmpLeft = dragOffsetLeft + x
        tmpDivider= dragOffsetDivider + x
        tmpRight = dragOffsetRight + x
        document.getElementById(left).style.width= tmpLeft + 'px';
        document.getElementById("divider").style.left= tmpDivider + 'px';
        document.getElementById(right).style.left = tmpRight + 'px';
      };
    </script>

<script type="text/javascript">

  function mexpand(id)
  {
    var n = document.getElementById(id).style;
    n.display = "block";
  }

  function mcollapse(id)
  {
    var n = document.getElementById(id).style;
    n.display = "none";
  }

  var counter_max = 0;
  function mshow(id,loc)
  {
    var i;
    for(i=1; i<=counter_max; ++i)
      mcollapse("menu"+String(i));
    mexpand(id);
    window.location.replace(loc);
  }
</script>

<script type="text/javascript">

function expand(but,id)
{
  var n = document.getElementById(id).style;
  var button = document.getElementById(but);
  button.src = "/share/src/web/images/minus.gif";
  button.alt = "-";
  n.display = "block";
}
function collapse(but,id)
{
  var n = document.getElementById(id).style;
  var button = document.getElementById(but);
  button.src = "/share/src/web/images/plus.gif";
  button.alt = "+";
  n.display = "none";
}
function toggle(button,id)
{
  var n = document.getElementById(id).style;
  if (n.display == "none")
  {
    button.src = "/share/src/web/images/minus.gif";
    button.alt = "-";
    n.display = "block";
  }
  else
  {
    button.src = "/share/src/web/images/plus.gif";
    button.alt = "+";
    n.display = "none";
  }
}
var allbuttons = [
"String handling",
"Strings",
"Equality and total ordering",
"Equality of <code>string</code> and <code>char</code>",
"Append to <code>string</code> object",
"Length of <code>string</code>",
"String concatenation.",
"Repetition of <code>string</code> or <code>char</code>",
"Application of <code>string</code> to <code>string</code> or <code>int</code> is concatenation",
"Construct a char from first byte of a <code>string</code>.",
"Constructors for <code>string</code>",
"Substrings",
"Map a string <code>char</code> by <code>char</code>",
"STL string functions",
"Construe <code>string</code> as set of <code>char</code>",
"Construe <code>string</code> as stream of <code>char</code>",
"Test if a string has given prefix or suffix",
"Trim off specified prefix or suffix or both",
"Strip characters from left, right, or both end of a string.",
"Justify string contents",
"Split a string into a list on given separator",
"erase, insert or replace substrings",
"search and replace",
"Regexp search and replace",
"Parse string to numeric type",
"Reserve store",
"Fetch underlying cstring.",
"Polymorphic vsprintf hack",
"Case translation",
"Transation to string"
];
function expand_all(dummy)
{
  for (i in allbuttons)
  {
    expand(allbuttons[i], allbuttons[i]+"_d");
  }
}
function collapse_all(dummy)
{
  for (i in allbuttons)
  {
    collapse(allbuttons[i], allbuttons[i]+"_d");
  }
}
</script>

<script>
function mouseover(id)
{
  var elt = document.getElementById(id);
  elt.style.display="none";
  var elt2 = document.getElementById(id+"_mo");
  elt2.style.display="inline";
}

function mouseout(id)
{
  var elt = document.getElementById(id+"_mo");
  elt.style.display="none";
  var elt2 = document.getElementById(id);
  elt2.style.display="inline";
}

</script>
<script> function nop(dummy) {} </script>
    <div class="container">
      <div class="toppanel">
    <!--Main Content top navbar-->
<span style="position:relative; bottom:6px"
  onmouseover="mouseover('expand')"
  onmouseout="mouseout('expand')"
  onclick="expand_all('expand')"
  ><span id="expand"><svg height="30px" width="65px"><rect x="4px" y="6px" rx="4px" ry="40px" width="60px" height="20px" style="fill:blue;opacity:0.2;stroke:black;stroke-width:2"/><text x="13px" y="21px" fill="black" style="font-size:12px;">Expand</text></svg></span><span id="expand_mo" style="display:none"><svg height="30px" width="65px"><rect x="4px" y="6px" rx="4px" ry="40px" width="60px" height="20px" style="fill:red;opacity:0.2;stroke:black;stroke-width:2"/><text x="13px" y="21px" fill="black" style="font-size:12px;">Expand</text></svg></span></span><span style="position:relative; bottom:6px"
  onmouseover="mouseover('collapse')"
  onmouseout="mouseout('collapse')"
  onclick="collapse_all('collapse')"
  ><span id="collapse"><svg height="30px" width="65px"><rect x="4px" y="6px" rx="4px" ry="40px" width="60px" height="20px" style="fill:blue;opacity:0.2;stroke:black;stroke-width:2"/><text x="13px" y="21px" fill="black" style="font-size:12px;">Collapse</text></svg></span><span id="collapse_mo" style="display:none"><svg height="30px" width="65px"><rect x="4px" y="6px" rx="4px" ry="40px" width="60px" height="20px" style="fill:red;opacity:0.2;stroke:black;stroke-width:2"/><text x="13px" y="21px" fill="black" style="font-size:12px;">Collapse</text></svg></span></span>    <!--Main Content top navbar End-->

      </div> <!-- toppanel end -->
      <div class="bottompanel">
        <span id="divider" class="divider"></span>

        <span id="left" class="leftpanel" >
          <div class="menucontent">
  <!--Left Margin Toc-->
  <div id="leftmargintoc">
    <!--Left Margin Toc Main Contents-->
      <div class=m1 onclick="mshow('menu1','#String handling_h')"> <a href="#String_handling_h">String handling</a></div>
      <div class=sm id=menu1>
      </div>
      <div class=m1 onclick="mshow('menu2','#Strings_h')"> <a href="#Strings_h">Strings</a></div>
      <div class=sm id=menu2>
      <div class=m2><a href="#Equality_and_total_ordering_h">Equality and total ordering</a></div>
      <div class=m2><a href="#Equality_of_<code>string</code>_and_<code>char</code>_h">Equality of <code>string</code> and <code>char</code></a></div>
      <div class=m2><a href="#Append_to_<code>string</code>_object_h">Append to <code>string</code> object</a></div>
      <div class=m2><a href="#Length_of_<code>string</code>_h">Length of <code>string</code></a></div>
      <div class=m2><a href="#String_concatenation._h">String concatenation.</a></div>
      <div class=m2><a href="#Repetition_of_<code>string</code>_or_<code>char</code>_h">Repetition of <code>string</code> or <code>char</code></a></div>
      <div class=m2><a href="#Application_of_<code>string</code>_to_<code>string</code>_or_<code>int</code>_is_concatenation_h">Application of <code>string</code> to <code>string</code> or <code>int</code> is concatenation</a></div>
      <div class=m2><a href="#Construct_a_char_from_first_byte_of_a_<code>string</code>._h">Construct a char from first byte of a <code>string</code>.</a></div>
      <div class=m2><a href="#Constructors_for_<code>string</code>_h">Constructors for <code>string</code></a></div>
      <div class=m2><a href="#Substrings_h">Substrings</a></div>
      <div class=m2><a href="#Map_a_string_<code>char</code>_by_<code>char</code>_h">Map a string <code>char</code> by <code>char</code></a></div>
      <div class=m2><a href="#STL_string_functions_h">STL string functions</a></div>
      <div class=m2><a href="#Construe_<code>string</code>_as_set_of_<code>char</code>_h">Construe <code>string</code> as set of <code>char</code></a></div>
      <div class=m2><a href="#Construe_<code>string</code>_as_stream_of_<code>char</code>_h">Construe <code>string</code> as stream of <code>char</code></a></div>
      <div class=m2><a href="#Test_if_a_string_has_given_prefix_or_suffix_h">Test if a string has given prefix or suffix</a></div>
      <div class=m2><a href="#Trim_off_specified_prefix_or_suffix_or_both_h">Trim off specified prefix or suffix or both</a></div>
      <div class=m2><a href="#Strip_characters_from_left,_right,_or_both_end_of_a_string._h">Strip characters from left, right, or both end of a string.</a></div>
      <div class=m2><a href="#Justify_string_contents_h">Justify string contents</a></div>
      <div class=m2><a href="#Split_a_string_into_a_list_on_given_separator_h">Split a string into a list on given separator</a></div>
      <div class=m2><a href="#erase,_insert_or_replace_substrings_h">erase, insert or replace substrings</a></div>
      <div class=m2><a href="#search_and_replace_h">search and replace</a></div>
      <div class=m2><a href="#Regexp_search_and_replace_h">Regexp search and replace</a></div>
      <div class=m2><a href="#Parse_string_to_numeric_type_h">Parse string to numeric type</a></div>
      <div class=m2><a href="#Reserve_store_h">Reserve store</a></div>
      <div class=m2><a href="#Fetch_underlying_cstring._h">Fetch underlying cstring.</a></div>
      <div class=m2><a href="#Polymorphic_vsprintf_hack_h">Polymorphic vsprintf hack</a></div>
      <div class=m2><a href="#Case_translation_h">Case translation</a></div>
      <div class=m2><a href="#Transation_to_string_h">Transation to string</a></div>
      </div>
    <script>counter_max=2;</script>
  </div>
  <!--End Left Margin Toc-->

          </div> <!-- leftpanel contents end -->
        </span> <!-- leftpanel end -->

        <span id="right" class="rightpanel">
          <div class="maincontent">
<!--Main Content Body-->
<h1 id='String_handling_h'><img src='/share/src/web/images/minus.gif' id='String handling' onclick='toggle(this,"String_handling_d")' alt='+'/> 1 String handling</h1><div id='String_handling_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/__init__.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>  <span class="big_keyword" title="Include a Felix file">include</span> <span class="fstring">"std/strings/string"</span>;
<span class="lineno" id=line2></span>  <span class="big_keyword" title="Include a Felix file">include</span> <span class="fstring">"std/strings/cstring"</span>;
<span class="lineno" id=line3></span>  <span class="big_keyword" title="Include a Felix file">include</span> <span class="fstring">"std/strings/ustr"</span>;
<span class="lineno" id=line4></span>  <span class="big_keyword" title="Include a Felix file">include</span> <span class="fstring">"std/strings/ucstr"</span>;
<span class="lineno" id=line5></span>  
</pre></p></div><h1 id='Strings_h'><img src='/share/src/web/images/minus.gif' id='Strings' onclick='toggle(this,"Strings_d")' alt='+'/> 2 Strings</h1><div id='Strings_d' style='display:block'>
<p>We have three string like things. <code>cstring</code> is just 
an alias for a NTBS (Null Terminated Byte String).
The workhorse <code>string</code> type based on C++ string.
</p><p>A <code>ustring</code> is a unicode representation using a 32 bit unsigned integer as
the character base.
This type is deprecated, to be repalced by C++11 unicode string type.
</p><pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>  <span class="big_keyword" title="Define an alias for a type expression">typedef</span> cstring = +<span class="library" title="binding of C char type">char</span>;
<span class="lineno" id=line2></span>  <span class="big_keyword" title="Define a primitive type by binding to a C type">type</span> <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"::std::basic_string&lt;char&gt;"</span> 
<span class="lineno" id=line3></span>    <span class="big_keyword" title="specify requirements">requires</span> index TYPE_string, Cxx_headers::<span class="library" title="binding of C++ string type">string</span>,
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Specify C code to be inserted into header file">header</span> '<span class="embedded_c">#<span class="preproc">include</span> <span class="fstring">"flx_serialisers.hpp"</span></span>',
<span class="lineno" id=line5></span>    <span class="small_keyword" title="serialisation encoder">encoder</span> <span class="fstring">"::flx::gc::generic::string_encoder"</span>,
<span class="lineno" id=line6></span>    <span class="small_keyword" title="serialisation decoder">decoder</span> <span class="fstring">"::flx::gc::generic::string_decoder"</span>
<span class="lineno" id=line7></span>  ;
<span class="lineno" id=line8></span>  typeset strings = {<span class="library" title="binding of C++ string type">string</span>};
<span class="lineno" id=line9></span>  
<span class="lineno" id=line10></span>  <span class="big_keyword" title="Define a type class">class</span> Str [T] {
<span class="lineno" id=line11></span>    <span class="qualifier" title="Type of a function to be provided in type class instances">virtual</span> <span class="big_keyword" title="Define a function with no side-effects">fun</span> <span class="library" title="Convert a value to a string">str</span>: T -&gt; <span class="library" title="binding of C++ string type">string</span>;
<span class="lineno" id=line12></span>  }
<span class="lineno" id=line13></span>  
<span class="lineno" id=line14></span>  <span class="big_keyword" title="Define a type class">class</span> Repr [T <span class="small_keyword" title="type-class constraint">with</span> Str[T]] {
<span class="lineno" id=line15></span>    <span class="qualifier" title="Type of a function to be provided in type class instances">virtual</span> <span class="big_keyword" title="Define a function with no side-effects">fun</span> repr (t:T) : <span class="library" title="binding of C++ string type">string</span> =&gt; <span class="library" title="Convert a value to a string">str</span> t;
<span class="lineno" id=line16></span>  }
<span class="lineno" id=line17></span>  
<span class="lineno" id=line18></span>  <span class="big_keyword" title="Define a type class">class</span> Show [T] {
<span class="lineno" id=line19></span>    <span class="big_keyword" title="Inherit symbols into a module or typeclass">inherit</span> Str[T];
<span class="lineno" id=line20></span>    <span class="big_keyword" title="Inherit symbols into a module or typeclass">inherit</span> Repr[T];
<span class="lineno" id=line21></span>  }
<span class="lineno" id=line22></span>  
<span class="lineno" id=line23></span>  
</pre></p><h2 id='Equality_and_total_ordering_h'><img src='/share/src/web/images/minus.gif' id='Equality and total ordering' onclick='toggle(this,"Equality_and_total_ordering_d")' alt='+'/> 2.1 Equality and total ordering</h2><div id='Equality_and_total_ordering_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>  <span class="big_keyword" title="Provide an instance of a typeclass">instance</span>[t <span class="small_keyword" title="membership operator, function mem">in</span> strings] Eq[t] {
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> == : t * t -&gt; bool = <span class="fstring">"$1==$2"</span>;
<span class="lineno" id=line3></span>  }
<span class="lineno" id=line4></span>  <span class="big_keyword" title="Provide an instance of a typeclass">instance</span>[t <span class="small_keyword" title="membership operator, function mem">in</span> strings] Tord[t] {
<span class="lineno" id=line5></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> &lt; : t * t -&gt; bool = <span class="fstring">"$1&lt;$2"</span>;
<span class="lineno" id=line6></span>  }
<span class="lineno" id=line7></span>  
<span class="lineno" id=line8></span>  <span class="big_keyword" title="Define a type class">class</span> String
<span class="lineno" id=line9></span>  {
<span class="lineno" id=line10></span>    <span class="big_keyword" title="Inherit symbols into a module or typeclass">inherit</span> Eq[<span class="library" title="binding of C++ string type">string</span>];
<span class="lineno" id=line11></span>  
<span class="lineno" id=line12></span>    <span class="big_keyword" title="Inherit symbols into a module or typeclass">inherit</span> Tord[<span class="library" title="binding of C++ string type">string</span>];
<span class="lineno" id=line13></span>  
</pre></p></div><h2 id='Equality_of_<code>string</code>_and_<code>char</code>_h'><img src='/share/src/web/images/minus.gif' id='Equality of <code>string</code> and <code>char</code>' onclick='toggle(this,"Equality_of_<code>string</code>_and_<code>char</code>_d")' alt='+'/> 2.2 Equality of <code>string</code> and <code>char</code></h2><div id='Equality_of_<code>string</code>_and_<code>char</code>_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> == (s:<span class="library" title="binding of C++ string type">string</span>, c:<span class="library" title="binding of C char type">char</span>) =&gt; <span class="library" title="number of elements in data structure">len</span> s == 1uz <span class="small_keyword" title="logical conjunction">and</span> s.[0] == c;
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> == (c:<span class="library" title="binding of C char type">char</span>, s:<span class="library" title="binding of C++ string type">string</span>) =&gt; <span class="library" title="number of elements in data structure">len</span> s == 1uz <span class="small_keyword" title="logical conjunction">and</span> s.[0] == c;
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> != (s:<span class="library" title="binding of C++ string type">string</span>, c:<span class="library" title="binding of C char type">char</span>) =&gt; <span class="library" title="number of elements in data structure">len</span> s != 1uz <span class="small_keyword" title="logical disjunction">or</span> s.[0] != c;
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> != (c:<span class="library" title="binding of C char type">char</span>, s:<span class="library" title="binding of C++ string type">string</span>) =&gt; <span class="library" title="number of elements in data structure">len</span> s != 1uz <span class="small_keyword" title="logical disjunction">or</span> s.[0] != c;
<span class="lineno" id=line5></span>  
</pre></p></div><h2 id='Append_to_<code>string</code>_object_h'><img src='/share/src/web/images/minus.gif' id='Append to <code>string</code> object' onclick='toggle(this,"Append_to_<code>string</code>_object_d")' alt='+'/> 2.3 Append to <code>string</code> object</h2><div id='Append_to_<code>string</code>_object_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span>  += : &amp;<span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1-&gt;append($2:assign);"</span>;
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span>  += : &amp;<span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> = <span class="fstring">"$1-&gt;append($2:assign);"</span>;
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span>  += : &amp;<span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> = <span class="fstring">"*$1 += $2;"</span>;
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span>  += : &amp;<span class="library" title="binding of C++ string type">string</span> * &amp;<span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1-&gt;append(*$2);"</span>;
<span class="lineno" id=line5></span>  
</pre></p></div><h2 id='Length_of_<code>string</code>_h'><img src='/share/src/web/images/minus.gif' id='Length of <code>string</code>' onclick='toggle(this,"Length_of_<code>string</code>_d")' alt='+'/> 2.4 Length of <code>string</code></h2><div id='Length_of_<code>string</code>_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="comment">// we need to cast to an int so that c++ won't complain</span>
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> <span class="library" title="number of elements in data structure">len</span>: <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.size()"</span>;
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> <span class="library" title="number of elements in data structure">len</span>: &amp;<span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1-&gt;size()"</span>;
<span class="lineno" id=line4></span>  
</pre></p></div><h2 id='String_concatenation._h'><img src='/share/src/web/images/minus.gif' id='String concatenation.' onclick='toggle(this,"String_concatenation._d")' alt='+'/> 2.5 String concatenation.</h2><div id='String_concatenation._d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> + : <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1+$2"</span>;
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> + : <span class="library" title="binding of C++ string type">string</span> * carray[<span class="library" title="binding of C char type">char</span>] -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1+$2"</span>;
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> + : <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1+$2"</span>;
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> + : <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1+$2"</span>;
<span class="lineno" id=line5></span>    <span class="comment">//fun + : string * int -&gt; string = "$1+::flx::rtl::i18n::utf8($2:assign)" is add requires package "flx_i18n";</span>
<span class="lineno" id=line6></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> + ( x:<span class="library" title="binding of C++ string type">string</span>,  y: <span class="library" title="binding of C int type">int</span>) =&gt; x + <span class="library" title="Convert a value to a string">str</span> y;
<span class="lineno" id=line7></span>  
<span class="lineno" id=line8></span>    <span class="comment">// may be a bit risky!</span>
<span class="lineno" id=line9></span>    <span class="comment">// IT WAS: interferes with "hello" + list ("world","blah"): </span>
<span class="lineno" id=line10></span>    <span class="comment">// is this a string or a list of strings?</span>
<span class="lineno" id=line11></span>    <span class="comment">//fun + [T with Str[T]] (x:string, y:T) =&gt; x + str y;</span>
<span class="lineno" id=line12></span>  
</pre></p></div><h2 id='Repetition_of_<code>string</code>_or_<code>char</code>_h'><img src='/share/src/web/images/minus.gif' id='Repetition of <code>string</code> or <code>char</code>' onclick='toggle(this,"Repetition_of_<code>string</code>_or_<code>char</code>_d")' alt='+'/> 2.6 Repetition of <code>string</code> or <code>char</code></h2><div id='Repetition_of_<code>string</code>_or_<code>char</code>_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> * : <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C int type">int</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"::flx::rtl::strutil::mul($1:assign,$2:assign)"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>;
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> * : <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C int type">int</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"::std::string($2:assign,$1:assign)"</span>;
<span class="lineno" id=line3></span>  
</pre></p></div><h2 id='Application_of_<code>string</code>_to_<code>string</code>_or_<code>int</code>_is_concatenation_h'><img src='/share/src/web/images/minus.gif' id='Application of <code>string</code> to <code>string</code> or <code>int</code> is concatenation' onclick='toggle(this,"Application_of_<code>string</code>_to_<code>string</code>_or_<code>int</code>_is_concatenation_d")' alt='+'/> 2.7 Application of <code>string</code> to <code>string</code> or <code>int</code> is concatenation</h2><div id='Application_of_<code>string</code>_to_<code>string</code>_or_<code>int</code>_is_concatenation_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> apply (x:<span class="library" title="binding of C++ string type">string</span>, y:<span class="library" title="binding of C++ string type">string</span>):<span class="library" title="binding of C++ string type">string</span> =&gt; x + y;
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> apply (x:<span class="library" title="binding of C++ string type">string</span>, y:<span class="library" title="binding of C int type">int</span>):<span class="library" title="binding of C++ string type">string</span> =&gt; x + y;
<span class="lineno" id=line3></span>  
</pre></p></div><h2 id='Construct_a_char_from_first_byte_of_a_<code>string</code>._h'><img src='/share/src/web/images/minus.gif' id='Construct a char from first byte of a <code>string</code>.' onclick='toggle(this,"Construct_a_char_from_first_byte_of_a_<code>string</code>._d")' alt='+'/> 2.8 Construct a char from first byte of a <code>string</code>.</h2><div id='Construct_a_char_from_first_byte_of_a_<code>string</code>._d' style='display:block'>
<p>Returns nul char (code 0) if the string is empty.
</p><pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a value constructor or conversion operator for a type">ctor</span> <span class="library" title="binding of C char type">char</span> (x:<span class="library" title="binding of C++ string type">string</span>) =&gt; x.[0];
</pre></p></div><h2 id='Constructors_for_<code>string</code>_h'><img src='/share/src/web/images/minus.gif' id='Constructors for <code>string</code>' onclick='toggle(this,"Constructors_for_<code>string</code>_d")' alt='+'/> 2.9 Constructors for <code>string</code></h2><div id='Constructors_for_<code>string</code>_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a value constructor or conversion operator for a type">ctor</span> <span class="library" title="binding of C++ string type">string</span> (c:<span class="library" title="binding of C char type">char</span>) =&gt; <span class="fstring">""</span>+c;
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a value constructor or conversion operator for a type">ctor</span> <span class="library" title="binding of C++ string type">string</span>: +<span class="library" title="binding of C char type">char</span> = <span class="fstring">"::std::string($1:assign)"</span>;
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a value constructor or conversion operator for a type">ctor</span> <span class="library" title="binding of C++ string type">string</span>: +<span class="library" title="binding of C char type">char</span>  * !ints = <span class="fstring">"::std::string($1:assign,$2:assign)"</span>;
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> utf8: <span class="library" title="binding of C int type">int</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"::flx::rtl::i18n::utf8($1)"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_i18n"</span>;
<span class="lineno" id=line5></span>  
</pre></p></div><h2 id='Substrings_h'><img src='/share/src/web/images/minus.gif' id='Substrings' onclick='toggle(this,"Substrings_d")' alt='+'/> 2.10 Substrings</h2><div id='Substrings_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> subscript: <span class="library" title="binding of C++ string type">string</span> * !ints -&gt; <span class="library" title="binding of C char type">char</span> =
<span class="lineno" id=line2></span>      <span class="fstring">"::flx::rtl::strutil::subscript($1:assign,$2:assign)"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>;
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> copyfrom: <span class="library" title="binding of C++ string type">string</span> * !ints -&gt; <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line4></span>      <span class="fstring">"::flx::rtl::strutil::substr($1:assign,$2:assign,$1:postfix.size())"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>;
<span class="lineno" id=line5></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> copyto: <span class="library" title="binding of C++ string type">string</span> * !ints -&gt; <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line6></span>      <span class="fstring">"::flx::rtl::strutil::substr($1:assign,0,$2:assign)"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>;
<span class="lineno" id=line7></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> substring: <span class="library" title="binding of C++ string type">string</span> * !ints * !ints -&gt; <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line8></span>      <span class="fstring">"::flx::rtl::strutil::substr($1:assign,$2:assign,$3:assign)"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>;
<span class="lineno" id=line9></span>  
<span class="lineno" id=line10></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> subscript (x:<span class="library" title="binding of C++ string type">string</span>, s:slice[<span class="library" title="binding of C int type">int</span>]):<span class="library" title="binding of C++ string type">string</span> =&gt;
<span class="lineno" id=line11></span>      <span class="small_keyword" title="match statement or expression">match</span> s <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line12></span>      | #Slice_all =&gt; substring (x, 0, x.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span>)
<span class="lineno" id=line13></span>      | Slice_from (start) =&gt; copyfrom (x, start)
<span class="lineno" id=line14></span>      | Slice_to_incl (<span class="small_keyword" title="end of extension">end</span>) =&gt; copyto (x, <span class="small_keyword" title="end of extension">end</span> + 1)
<span class="lineno" id=line15></span>      | Slice_to_excl (<span class="small_keyword" title="end of extension">end</span>) =&gt; copyto (x, <span class="small_keyword" title="end of extension">end</span>)
<span class="lineno" id=line16></span>      | Slice_range_incl (start, <span class="small_keyword" title="end of extension">end</span>) =&gt; substring (x, start, <span class="small_keyword" title="end of extension">end</span> + 1)
<span class="lineno" id=line17></span>      | Slice_range_excl (start, <span class="small_keyword" title="end of extension">end</span>) =&gt; substring (x, start, <span class="small_keyword" title="end of extension">end</span>)
<span class="lineno" id=line18></span>      | Slice_from_counted (start, count) =&gt; substring (x,start, start + count)
<span class="lineno" id=line19></span>      | Slice_one (index) =&gt; <span class="library" title="binding of C++ string type">string</span> x.[index]
<span class="lineno" id=line20></span>      <span class="small_keyword" title="end a match statement or expression">endmatch</span>
<span class="lineno" id=line21></span>    ;
<span class="lineno" id=line22></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> apply (s:slice[<span class="library" title="binding of C int type">int</span>], x:<span class="library" title="binding of C++ string type">string</span>) =&gt; subscript (x,s);
<span class="lineno" id=line23></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> apply (i:<span class="library" title="binding of C int type">int</span>, x:<span class="library" title="binding of C++ string type">string</span>) =&gt; subscript (x,i);
<span class="lineno" id=line24></span>  
<span class="lineno" id=line25></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> subscript (x:<span class="library" title="binding of C++ string type">string</span>, gs:gslice[<span class="library" title="binding of C int type">int</span>]):<span class="library" title="binding of C++ string type">string</span> = {
<span class="lineno" id=line26></span>      <span class="big_keyword" title="Define a mutable variable">var</span> r = <span class="fstring">""</span>;
<span class="lineno" id=line27></span>      <span class="small_keyword" title="match statement or expression">match</span> gs <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line28></span>      | GSlice s =&gt; r = subscript(x,s);
<span class="lineno" id=line29></span>      | GSSList gsl =&gt;
<span class="lineno" id=line30></span>        <span class="comment">// this should be faster cause it cats a list of string which</span>
<span class="lineno" id=line31></span>        <span class="comment">// is linear in the number of strings</span>
<span class="lineno" id=line32></span>        <span class="big_keyword" title="Define a mutable variable">var</span> sl = Empty[<span class="library" title="binding of C++ string type">string</span>]; 
<span class="lineno" id=line33></span>        <span class="small_keyword" title="for loop">for</span> gs <span class="small_keyword" title="membership operator, function mem">in</span> gsl perform sl = subscript (x,gs) + sl;
<span class="lineno" id=line34></span>        r = sl.<span class="library" title="return data structure with elements reversed">rev</span>.(cat <span class="fstring">""</span>);
<span class="lineno" id=line35></span>      | _ =&gt; 
<span class="lineno" id=line36></span>        <span class="small_keyword" title="for loop">for</span> i <span class="small_keyword" title="membership operator, function mem">in</span> gs perform r += x.[i];
<span class="lineno" id=line37></span>      <span class="small_keyword" title="end a match statement or expression">endmatch</span>; 
<span class="lineno" id=line38></span>      <span class="small_keyword" title="return">return</span> r;
<span class="lineno" id=line39></span>    }
<span class="lineno" id=line40></span>   
<span class="lineno" id=line41></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span> store: &amp;<span class="library" title="binding of C++ string type">string</span> * !ints * <span class="library" title="binding of C char type">char</span> = <span class="fstring">"(*$1)[$2] = $3;"</span>;
<span class="lineno" id=line42></span>  
</pre></p></div><h2 id='Map_a_string_<code>char</code>_by_<code>char</code>_h'><img src='/share/src/web/images/minus.gif' id='Map a string <code>char</code> by <code>char</code>' onclick='toggle(this,"Map_a_string_<code>char</code>_by_<code>char</code>_d")' alt='+'/> 2.11 Map a string <code>char</code> by <code>char</code></h2><div id='Map_a_string_<code>char</code>_by_<code>char</code>_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> <span class="library" title="return data structure with function applied to each value">map</span> (f:char-&gt;<span class="library" title="binding of C char type">char</span>) (<span class="big_keyword" title="Define a mutable variable">var</span> x:<span class="library" title="binding of C++ string type">string</span>): <span class="library" title="binding of C++ string type">string</span> = {
<span class="lineno" id=line2></span>      <span class="small_keyword" title="conditional">if</span> <span class="library" title="number of elements in data structure">len</span> x &gt; 0uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line3></span>        <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> i <span class="small_keyword" title="membership operator, function mem">in</span> 0uz <span class="small_keyword" title="upwards counting for loop">upto</span> (<span class="library" title="number of elements in data structure">len</span> x) - 1uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line4></span>          store(&amp;x, i, f x.[i]);
<span class="lineno" id=line5></span>        <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line6></span>      <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line7></span>      <span class="small_keyword" title="return">return</span> x;
<span class="lineno" id=line8></span>    }
<span class="lineno" id=line9></span>  
</pre></p></div><h2 id='STL_string_functions_h'><img src='/share/src/web/images/minus.gif' id='STL string functions' onclick='toggle(this,"STL_string_functions_d")' alt='+'/> 2.12 STL string functions</h2><div id='STL_string_functions_d' style='display:block'>
<p>These come in two flavours: the standard C++ operations
which return <code>stl_npos</code> on failure, and a more Felix
like variant which uses an <code>option</code> type.
</p><pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Bind a Felix symbol to a C expression">const</span> stl_npos: <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"::std::string::npos"</span>;
<span class="lineno" id=line2></span>  
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find($2)"</span> is cast;
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find($2,$3)"</span> is cast;
<span class="lineno" id=line5></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find($2)"</span> is cast;
<span class="lineno" id=line6></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find($2,$3)"</span> is cast;
<span class="lineno" id=line7></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find($2)"</span> is cast;
<span class="lineno" id=line8></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find($2,$3)"</span> is cast;
<span class="lineno" id=line9></span>  
<span class="lineno" id=line10></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line11></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line12></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i== stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line13></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line14></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line15></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line16></span>  
<span class="lineno" id=line17></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_rfind: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.rfind($2)"</span>;
<span class="lineno" id=line18></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_rfind: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.rfind($2,$3)"</span>;
<span class="lineno" id=line19></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_rfind: <span class="library" title="binding of C++ string type">string</span> * +char-&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.rfind($2)"</span>;
<span class="lineno" id=line20></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_rfind: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.rfind($2,$3)"</span>;
<span class="lineno" id=line21></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_rfind: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.rfind($2)"</span>;
<span class="lineno" id=line22></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_rfind: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.rfind($2,$3)"</span>;
<span class="lineno" id=line23></span>  
<span class="lineno" id=line24></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rfind (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_rfind (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line25></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rfind (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_rfind (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line26></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rfind (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_rfind (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line27></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rfind (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_rfind (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line28></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rfind (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_rfind (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line29></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rfind (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_rfind (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line30></span>  
<span class="lineno" id=line31></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_of($2)"</span>;
<span class="lineno" id=line32></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_of($2,$3)"</span>;
<span class="lineno" id=line33></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_of($2)"</span>;
<span class="lineno" id=line34></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_of($2,$3)"</span>;
<span class="lineno" id=line35></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_of($2)"</span>;
<span class="lineno" id=line36></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_of($2,$3)"</span>;
<span class="lineno" id=line37></span>  
<span class="lineno" id=line38></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line39></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line40></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line41></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line42></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line43></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line44></span>  
<span class="lineno" id=line45></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_not_of($2)"</span>;
<span class="lineno" id=line46></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_not_of($2,$3)"</span>;
<span class="lineno" id=line47></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_not_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_not_of($2)"</span>;
<span class="lineno" id=line48></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_not_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_not_of($2,$3)"</span>;
<span class="lineno" id=line49></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_not_of($2)"</span>;
<span class="lineno" id=line50></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_first_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_first_not_of($2,$3)"</span>;
<span class="lineno" id=line51></span>  
<span class="lineno" id=line52></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_not_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line53></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_not_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line54></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_not_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line55></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_not_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line56></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_not_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line57></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_first_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_not_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line58></span>  
<span class="lineno" id=line59></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_of($2)"</span>;
<span class="lineno" id=line60></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_of($2,$3)"</span>;
<span class="lineno" id=line61></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_of($2)"</span>;
<span class="lineno" id=line62></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_of($2,$3)"</span>;
<span class="lineno" id=line63></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_of($2)"</span>;
<span class="lineno" id=line64></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_of($2,$3)"</span>;
<span class="lineno" id=line65></span>  
<span class="lineno" id=line66></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line67></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line68></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line69></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line70></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line71></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line72></span>  
<span class="lineno" id=line73></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_not_of($2)"</span>;
<span class="lineno" id=line74></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_not_of($2,$3)"</span>;
<span class="lineno" id=line75></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_not_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_not_of($2)"</span>;
<span class="lineno" id=line76></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_not_of: <span class="library" title="binding of C++ string type">string</span> * +<span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_not_of($2,$3)"</span>;
<span class="lineno" id=line77></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_not_of($2)"</span>;
<span class="lineno" id=line78></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_find_last_not_of: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C char type">char</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1.find_last_not_of($2,$3)"</span>;
<span class="lineno" id=line79></span>  
<span class="lineno" id=line80></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_not_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line81></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_not_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line82></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_not_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line83></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:+<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_not_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line84></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_not_of (s, e) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line85></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> find_last_not_of (s:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C char type">char</span>, i:<span class="library" title="binding of C size_t type">size</span>) : <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C size_t type">size</span>] =&gt; <span class="small_keyword" title="match statement or expression">match</span> stl_find_last_not_of (s, e, i) <span class="small_keyword" title="type-class constraint">with</span> | i <span class="small_keyword" title="predicative type constraint or precondition">when</span> i == stl_npos =&gt; None[<span class="library" title="binding of C size_t type">size</span>] | i =&gt; Some i <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line86></span>  
<span class="lineno" id=line87></span>    
</pre></p></div><h2 id='Construe_<code>string</code>_as_set_of_<code>char</code>_h'><img src='/share/src/web/images/minus.gif' id='Construe <code>string</code> as set of <code>char</code>' onclick='toggle(this,"Construe_<code>string</code>_as_set_of_<code>char</code>_d")' alt='+'/> 2.13 Construe <code>string</code> as set of <code>char</code></h2><div id='Construe_<code>string</code>_as_set_of_<code>char</code>_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Provide an instance of a typeclass">instance</span> Set[<span class="library" title="binding of C++ string type">string</span>,<span class="library" title="binding of C char type">char</span>] {
<span class="lineno" id=line2></span>      <span class="big_keyword" title="Define a function with no side-effects">fun</span> <span class="tex_symbol" title="\in">\(\in\)</span> (c:<span class="library" title="binding of C char type">char</span>, s:<span class="library" title="binding of C++ string type">string</span>) =&gt; stl_find (s,c) != stl_npos;
<span class="lineno" id=line3></span>    }
<span class="lineno" id=line4></span>    
</pre></p></div><h2 id='Construe_<code>string</code>_as_stream_of_<code>char</code>_h'><img src='/share/src/web/images/minus.gif' id='Construe <code>string</code> as stream of <code>char</code>' onclick='toggle(this,"Construe_<code>string</code>_as_stream_of_<code>char</code>_d")' alt='+'/> 2.14 Construe <code>string</code> as stream of <code>char</code></h2><div id='Construe_<code>string</code>_as_stream_of_<code>char</code>_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Provide an instance of a typeclass">instance</span> Iterable[<span class="library" title="binding of C++ string type">string</span>, <span class="library" title="binding of C char type">char</span>] {
<span class="lineno" id=line2></span>      <span class="big_keyword" title="Define a generator, a function with side-effects returning a value">gen</span> iterator(<span class="big_keyword" title="Define a mutable variable">var</span> x:<span class="library" title="binding of C++ string type">string</span>) () = {
<span class="lineno" id=line3></span>        <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> i <span class="small_keyword" title="membership operator, function mem">in</span> 0 <span class="small_keyword" title="upwards counting for loop">upto</span> x.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> - 1 <span class="small_keyword" title="imperative code begins">do</span> <span class="small_keyword" title="return a value saving the current location for future resumption">yield</span> Some (x.[i]); <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line4></span>        <span class="small_keyword" title="return">return</span> None[<span class="library" title="binding of C char type">char</span>];
<span class="lineno" id=line5></span>      }
<span class="lineno" id=line6></span>    }
<span class="lineno" id=line7></span>    <span class="big_keyword" title="Inherit symbols into a module or typeclass">inherit</span> Streamable[<span class="library" title="binding of C++ string type">string</span>,<span class="library" title="binding of C char type">char</span>];
<span class="lineno" id=line8></span>  
</pre></p></div><h2 id='Test_if_a_string_has_given_prefix_or_suffix_h'><img src='/share/src/web/images/minus.gif' id='Test if a string has given prefix or suffix' onclick='toggle(this,"Test_if_a_string_has_given_prefix_or_suffix_d")' alt='+'/> 2.15 Test if a string has given prefix or suffix</h2><div id='Test_if_a_string_has_given_prefix_or_suffix_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> prefix(arg:<span class="library" title="binding of C++ string type">string</span>,key:<span class="library" title="binding of C++ string type">string</span>)=&gt;
<span class="lineno" id=line2></span>      arg.[<span class="small_keyword" title="substring range separator">to</span> <span class="library" title="number of elements in data structure">len</span> key]==key
<span class="lineno" id=line3></span>    ;
<span class="lineno" id=line4></span>  
<span class="lineno" id=line5></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> suffix (arg:<span class="library" title="binding of C++ string type">string</span>,key:<span class="library" title="binding of C++ string type">string</span>)=&gt;
<span class="lineno" id=line6></span>      arg.[-key.<span class="library" title="number of elements in data structure">len</span> <span class="small_keyword" title="substring range separator">to</span>]==key
<span class="lineno" id=line7></span>    ;
<span class="lineno" id=line8></span>  
<span class="lineno" id=line9></span>  
<span class="lineno" id=line10></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> startswith (x:<span class="library" title="binding of C++ string type">string</span>) (e:<span class="library" title="binding of C++ string type">string</span>) : bool =&gt; prefix (x,e);
<span class="lineno" id=line11></span>  
<span class="lineno" id=line12></span>    <span class="comment">// as above: slices are faster</span>
<span class="lineno" id=line13></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> endswith (x:<span class="library" title="binding of C++ string type">string</span>) (e:<span class="library" title="binding of C++ string type">string</span>) : bool =&gt; suffix (x,e);
<span class="lineno" id=line14></span>  
<span class="lineno" id=line15></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> startswith (x:<span class="library" title="binding of C++ string type">string</span>) (e:<span class="library" title="binding of C char type">char</span>) : bool =&gt; x.[0] == e;
<span class="lineno" id=line16></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> endswith (x:<span class="library" title="binding of C++ string type">string</span>) (e:<span class="library" title="binding of C char type">char</span>) : bool =&gt; x.[-1] == e;
<span class="lineno" id=line17></span>  
</pre></p></div><h2 id='Trim_off_specified_prefix_or_suffix_or_both_h'><img src='/share/src/web/images/minus.gif' id='Trim off specified prefix or suffix or both' onclick='toggle(this,"Trim_off_specified_prefix_or_suffix_or_both_d")' alt='+'/> 2.16 Trim off specified prefix or suffix or both</h2><div id='Trim_off_specified_prefix_or_suffix_or_both_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> ltrim (x:<span class="library" title="binding of C++ string type">string</span>) (e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt;
<span class="lineno" id=line2></span>      <span class="small_keyword" title="conditional">if</span> startswith x e <span class="small_keyword" title="conditional">then</span>
<span class="lineno" id=line3></span>        x.[e.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> <span class="small_keyword" title="substring range separator">to</span>]
<span class="lineno" id=line4></span>      <span class="small_keyword" title="conditional">else</span>
<span class="lineno" id=line5></span>        x
<span class="lineno" id=line6></span>      <span class="small_keyword" title="conditional">endif</span>
<span class="lineno" id=line7></span>    ;
<span class="lineno" id=line8></span>  
<span class="lineno" id=line9></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rtrim (x:<span class="library" title="binding of C++ string type">string</span>) (e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt;
<span class="lineno" id=line10></span>      <span class="small_keyword" title="conditional">if</span> endswith x e <span class="small_keyword" title="conditional">then</span>
<span class="lineno" id=line11></span>        x.[<span class="small_keyword" title="substring range separator">to</span> x.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> - e.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span>]
<span class="lineno" id=line12></span>      <span class="small_keyword" title="conditional">else</span>
<span class="lineno" id=line13></span>        x
<span class="lineno" id=line14></span>      <span class="small_keyword" title="conditional">endif</span>
<span class="lineno" id=line15></span>    ;
<span class="lineno" id=line16></span>  
<span class="lineno" id=line17></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> trim (x:<span class="library" title="binding of C++ string type">string</span>) (e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt; ltrim (rtrim x e) e;
<span class="lineno" id=line18></span>  
</pre></p></div><h2 id='Strip_characters_from_left,_right,_or_both_end_of_a_string._h'><img src='/share/src/web/images/minus.gif' id='Strip characters from left, right, or both end of a string.' onclick='toggle(this,"Strip_characters_from_left,_right,_or_both_end_of_a_string._d")' alt='+'/> 2.17 Strip characters from left, right, or both end of a string.</h2><div id='Strip_characters_from_left,_right,_or_both_end_of_a_string._d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> lstrip (x:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line2></span>    {
<span class="lineno" id=line3></span>      <span class="small_keyword" title="conditional">if</span> <span class="library" title="number of elements in data structure">len</span> x &gt; 0uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line4></span>        <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> i <span class="small_keyword" title="membership operator, function mem">in</span> 0uz <span class="small_keyword" title="upwards counting for loop">upto</span> <span class="library" title="number of elements in data structure">len</span> x - 1uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line5></span>          <span class="big_keyword" title="Define a mutable variable">var</span> found = <span class="library" title="false value">false</span>;
<span class="lineno" id=line6></span>          <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> j <span class="small_keyword" title="membership operator, function mem">in</span> 0uz <span class="small_keyword" title="upwards counting for loop">upto</span> <span class="library" title="number of elements in data structure">len</span> e - 1uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line7></span>            <span class="small_keyword" title="conditional">if</span> x.[i] == e.[j] <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line8></span>              found = <span class="library" title="truth value">true</span>;
<span class="lineno" id=line9></span>            <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line10></span>          <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line11></span>  
<span class="lineno" id=line12></span>          <span class="small_keyword" title="conditional">if</span> <span class="small_keyword" title="logical negation">not</span> found <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line13></span>            <span class="small_keyword" title="return">return</span> x.[i <span class="small_keyword" title="substring range separator">to</span>];
<span class="lineno" id=line14></span>          <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line15></span>        <span class="small_keyword" title="end of body">done</span>;
<span class="lineno" id=line16></span>      <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line17></span>      <span class="small_keyword" title="return">return</span> <span class="fstring">''</span>;
<span class="lineno" id=line18></span>    }
<span class="lineno" id=line19></span>  
<span class="lineno" id=line20></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rstrip (x:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line21></span>    {
<span class="lineno" id=line22></span>      <span class="small_keyword" title="conditional">if</span> <span class="library" title="number of elements in data structure">len</span> x &gt; 0uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line23></span>        <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> i <span class="small_keyword" title="membership operator, function mem">in</span> <span class="library" title="number of elements in data structure">len</span> x - 1uz <span class="small_keyword" title="downwards counting for loop">downto</span> 0uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line24></span>          <span class="big_keyword" title="Define a mutable variable">var</span> found = <span class="library" title="false value">false</span>;
<span class="lineno" id=line25></span>          <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> j <span class="small_keyword" title="membership operator, function mem">in</span> 0uz <span class="small_keyword" title="upwards counting for loop">upto</span> <span class="library" title="number of elements in data structure">len</span> e - 1uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line26></span>            <span class="small_keyword" title="conditional">if</span> x.[i] == e.[j] <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line27></span>              found = <span class="library" title="truth value">true</span>;
<span class="lineno" id=line28></span>            <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line29></span>          <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line30></span>  
<span class="lineno" id=line31></span>          <span class="small_keyword" title="conditional">if</span> <span class="small_keyword" title="logical negation">not</span> found <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line32></span>            <span class="small_keyword" title="return">return</span> x.[<span class="small_keyword" title="substring range separator">to</span> i.<span class="library" title="binding of C int type">int</span> + 1];
<span class="lineno" id=line33></span>          <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line34></span>        <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line35></span>      <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line36></span>      <span class="small_keyword" title="return">return</span> <span class="fstring">''</span>;
<span class="lineno" id=line37></span>    }
<span class="lineno" id=line38></span>  
<span class="lineno" id=line39></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> strip (x:<span class="library" title="binding of C++ string type">string</span>, e:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt; lstrip(rstrip(x, e), e);
<span class="lineno" id=line40></span>  
<span class="lineno" id=line41></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> lstrip (x:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt; lstrip(x, <span class="fstring">" \t\n\r\f\v"</span>);
<span class="lineno" id=line42></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rstrip (x:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt; rstrip(x, <span class="fstring">" \t\n\r\f\v"</span>);
<span class="lineno" id=line43></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> strip (x:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt; lstrip$ rstrip x;
<span class="lineno" id=line44></span>  
</pre></p></div><h2 id='Justify_string_contents_h'><img src='/share/src/web/images/minus.gif' id='Justify string contents' onclick='toggle(this,"Justify_string_contents_d")' alt='+'/> 2.18 Justify string contents</h2><div id='Justify_string_contents_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> ljust(x:<span class="library" title="binding of C++ string type">string</span>, width:<span class="library" title="binding of C int type">int</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt;
<span class="lineno" id=line2></span>      <span class="small_keyword" title="conditional">if</span> x.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> &gt;= width
<span class="lineno" id=line3></span>        <span class="small_keyword" title="conditional">then</span> x
<span class="lineno" id=line4></span>        <span class="small_keyword" title="conditional">else</span> x + (<span class="fstring">' '</span> * (width - x.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span>))
<span class="lineno" id=line5></span>      <span class="small_keyword" title="conditional">endif</span>
<span class="lineno" id=line6></span>    ;
<span class="lineno" id=line7></span>  
<span class="lineno" id=line8></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rjust(x:<span class="library" title="binding of C++ string type">string</span>, width:<span class="library" title="binding of C int type">int</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt;
<span class="lineno" id=line9></span>      <span class="small_keyword" title="conditional">if</span> x.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> &gt;= width
<span class="lineno" id=line10></span>        <span class="small_keyword" title="conditional">then</span> x
<span class="lineno" id=line11></span>        <span class="small_keyword" title="conditional">else</span> (<span class="fstring">' '</span> * (width - x.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span>)) + x
<span class="lineno" id=line12></span>      <span class="small_keyword" title="conditional">endif</span>
<span class="lineno" id=line13></span>    ;
<span class="lineno" id=line14></span>  
</pre></p></div><h2 id='Split_a_string_into_a_list_on_given_separator_h'><img src='/share/src/web/images/minus.gif' id='Split a string into a list on given separator' onclick='toggle(this,"Split_a_string_into_a_list_on_given_separator_d")' alt='+'/> 2.19 Split a string into a list on given separator</h2><div id='Split_a_string_into_a_list_on_given_separator_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> split (x:<span class="library" title="binding of C++ string type">string</span>, d:<span class="library" title="binding of C char type">char</span>): List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>] =&gt; unbox (List::<span class="library" title="return data structure with elements reversed">rev</span> (rev_split (x,d)));
<span class="lineno" id=line2></span>  
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rev_split (x:<span class="library" title="binding of C++ string type">string</span>, d:<span class="library" title="binding of C char type">char</span>): uniq (List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>]) = {
<span class="lineno" id=line4></span>      <span class="big_keyword" title="Define a function with no side-effects">fun</span> aux (x:<span class="library" title="binding of C++ string type">string</span>,y:List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>]) =&gt;
<span class="lineno" id=line5></span>        <span class="small_keyword" title="match statement or expression">match</span> find (x, d) <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line6></span>        | #None =&gt; Cons (x, y)
<span class="lineno" id=line7></span>        | Some n =&gt; aux$ x.[n+1uz <span class="small_keyword" title="substring range separator">to</span>], List::Cons (x.[<span class="small_keyword" title="substring range separator">to</span> n],y)
<span class="lineno" id=line8></span>        <span class="small_keyword" title="end a match statement or expression">endmatch</span>
<span class="lineno" id=line9></span>      ;
<span class="lineno" id=line10></span>      <span class="small_keyword" title="return">return</span> box (aux$ x, List::Empty[<span class="library" title="binding of C++ string type">string</span>]);
<span class="lineno" id=line11></span>    }
<span class="lineno" id=line12></span>  
<span class="lineno" id=line13></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> split (x:<span class="library" title="binding of C++ string type">string</span>, d:<span class="library" title="binding of C++ string type">string</span>): List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>] =&gt; unbox (List::<span class="library" title="return data structure with elements reversed">rev</span> (rev_split (x,d)));
<span class="lineno" id=line14></span>  
<span class="lineno" id=line15></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rev_split (x:<span class="library" title="binding of C++ string type">string</span>, d:<span class="library" title="binding of C++ string type">string</span>): uniq List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>] = {
<span class="lineno" id=line16></span>      <span class="big_keyword" title="Define a function with no side-effects">fun</span> aux (pos:<span class="library" title="binding of C size_t type">size</span>,y:List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>]) =&gt;
<span class="lineno" id=line17></span>        <span class="small_keyword" title="match statement or expression">match</span> stl_find_first_of (x, d, pos) <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line18></span>        | $(stl_npos) =&gt; List::Cons (x.[pos <span class="small_keyword" title="substring range separator">to</span>],y)
<span class="lineno" id=line19></span>        | n =&gt; aux$ (n+1uz), List::Cons (x.[pos <span class="small_keyword" title="substring range separator">to</span> n],y)
<span class="lineno" id=line20></span>        <span class="small_keyword" title="end a match statement or expression">endmatch</span>
<span class="lineno" id=line21></span>      ;
<span class="lineno" id=line22></span>      <span class="small_keyword" title="return">return</span> box (aux$ 0uz, List::Empty[<span class="library" title="binding of C++ string type">string</span>]);
<span class="lineno" id=line23></span>    }
<span class="lineno" id=line24></span>  
<span class="lineno" id=line25></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> split (x:<span class="library" title="binding of C++ string type">string</span>, d:+<span class="library" title="binding of C char type">char</span>): List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>] =&gt; unbox (List::<span class="library" title="return data structure with elements reversed">rev</span> (rev_split (x,d)));
<span class="lineno" id=line26></span>  
<span class="lineno" id=line27></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> rev_split (x:<span class="library" title="binding of C++ string type">string</span>, d:+<span class="library" title="binding of C char type">char</span>): uniq (List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>]) = {
<span class="lineno" id=line28></span>      <span class="big_keyword" title="Define a function with no side-effects">fun</span> aux (x:<span class="library" title="binding of C++ string type">string</span>,y:List::<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>]) =&gt;
<span class="lineno" id=line29></span>        <span class="small_keyword" title="match statement or expression">match</span> find_first_of (x, d) <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line30></span>        | #None =&gt; List::Cons (x, y)
<span class="lineno" id=line31></span>        | Some n =&gt; aux$ x.[n+1uz <span class="small_keyword" title="substring range separator">to</span>], List::Cons (x.[<span class="small_keyword" title="substring range separator">to</span> n],y)
<span class="lineno" id=line32></span>        <span class="small_keyword" title="end a match statement or expression">endmatch</span>
<span class="lineno" id=line33></span>      ;
<span class="lineno" id=line34></span>      <span class="small_keyword" title="return">return</span> box (aux$ x, List::Empty[<span class="library" title="binding of C++ string type">string</span>]);
<span class="lineno" id=line35></span>    }
<span class="lineno" id=line36></span>  
<span class="lineno" id=line37></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> split_first (x:<span class="library" title="binding of C++ string type">string</span>, d:<span class="library" title="binding of C++ string type">string</span>): <span class="library" title="option type: Some x or None">opt</span>[<span class="library" title="binding of C++ string type">string</span>*<span class="library" title="binding of C++ string type">string</span>] =&gt;
<span class="lineno" id=line38></span>      <span class="small_keyword" title="match statement or expression">match</span> find_first_of (x, d) <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line39></span>      | #None =&gt; None[<span class="library" title="binding of C++ string type">string</span>*<span class="library" title="binding of C++ string type">string</span>]
<span class="lineno" id=line40></span>      | Some n =&gt; Some (x.[<span class="small_keyword" title="substring range separator">to</span> n],substring(x,n+1uz,(<span class="library" title="number of elements in data structure">len</span> x)))
<span class="lineno" id=line41></span>      <span class="small_keyword" title="end a match statement or expression">endmatch</span>
<span class="lineno" id=line42></span>    ;
<span class="lineno" id=line43></span>  
<span class="lineno" id=line44></span>  
<span class="lineno" id=line45></span>    <span class="doccomment">Split a string on whitespace but respecting</span>
<span class="lineno" id=line46></span>    <span class="doccomment">double quotes, single quotes, and slosh escapes.</span>
<span class="lineno" id=line47></span>    <span class="comment">// leading and trailing space is removed. Embedded</span>
<span class="lineno" id=line48></span>    <span class="comment">// multiple spaces cause a single split.</span>
<span class="lineno" id=line49></span>    <span class="big_keyword" title="Define a type class">class</span> RespectfulParser {
<span class="lineno" id=line50></span>      variant quote_action_t = 
<span class="lineno" id=line51></span>        | ignore-quote
<span class="lineno" id=line52></span>        | keep-quote
<span class="lineno" id=line53></span>        | drop-quote
<span class="lineno" id=line54></span>      ; 
<span class="lineno" id=line55></span>      variant dquote_action_t = 
<span class="lineno" id=line56></span>        | ignore-dquote
<span class="lineno" id=line57></span>        | keep-dquote
<span class="lineno" id=line58></span>        | drop-dquote
<span class="lineno" id=line59></span>      ; 
<span class="lineno" id=line60></span>      variant escape_action_t = 
<span class="lineno" id=line61></span>        | ignore-escape
<span class="lineno" id=line62></span>        | keep-escape
<span class="lineno" id=line63></span>        | drop-escape
<span class="lineno" id=line64></span>      ; 
<span class="lineno" id=line65></span>      <span class="big_keyword" title="Define an alias for a type expression">typedef</span> action_t = (quote:quote_action_t, dquote:dquote_action_t, escape:escape_action_t);
<span class="lineno" id=line66></span>  
<span class="lineno" id=line67></span>      variant mode_t = | copying | skipping | quote | dquote | escape-copying | escape-quote | escape-dquote;
<span class="lineno" id=line68></span>      <span class="big_keyword" title="Define an alias for a type expression">typedef</span> state_t = (mode:mode_t, current:<span class="library" title="binding of C++ string type">string</span>, parsed: <span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>] );
<span class="lineno" id=line69></span>  
<span class="lineno" id=line70></span>      <span class="qualifier" title="Function or procedure which must not be inlined">noinline</span> <span class="big_keyword" title="Define a function with no side-effects">fun</span> respectful_parse (action:action_t) (<span class="big_keyword" title="Define a mutable variable">var</span> state:state_t) (<span class="big_keyword" title="Define a mutable variable">var</span> s:<span class="library" title="binding of C++ string type">string</span>) : state_t = 
<span class="lineno" id=line71></span>      {
<span class="lineno" id=line72></span>        <span class="big_keyword" title="Define a mutable variable">var</span> mode = state.mode;
<span class="lineno" id=line73></span>        <span class="big_keyword" title="Define a mutable variable">var</span> current = state.current;
<span class="lineno" id=line74></span>        <span class="big_keyword" title="Define a mutable variable">var</span> <span class="small_keyword" title="value of function return used in post condition">result</span> = Empty[<span class="library" title="binding of C++ string type">string</span>];
<span class="lineno" id=line75></span>  
<span class="lineno" id=line76></span>        <span class="qualifier" title="Function or procedure which must not be inlined">noinline</span> <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span> handlecopying(ch:<span class="library" title="binding of C char type">char</span>) {
<span class="lineno" id=line77></span>          <span class="small_keyword" title="conditional">if</span> ch == <span class="library" title="binding of C char type">char</span> <span class="fstring">"'"</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line78></span>            <span class="small_keyword" title="match statement or expression">match</span> action.quote <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line79></span>            | #ignore-quote =&gt; 
<span class="lineno" id=line80></span>              current += ch;
<span class="lineno" id=line81></span>            | #keep-quote =&gt;
<span class="lineno" id=line82></span>              current += ch;
<span class="lineno" id=line83></span>              mode = quote;
<span class="lineno" id=line84></span>            | #drop-quote =&gt;
<span class="lineno" id=line85></span>              mode = quote;
<span class="lineno" id=line86></span>            <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line87></span>          <span class="small_keyword" title="conditional">elif</span> ch == <span class="library" title="binding of C char type">char</span> <span class="fstring">'"'</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line88></span>            <span class="small_keyword" title="match statement or expression">match</span> action.dquote <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line89></span>            | #ignore-dquote =&gt; 
<span class="lineno" id=line90></span>              current += ch;
<span class="lineno" id=line91></span>            | #keep-dquote =&gt;
<span class="lineno" id=line92></span>              current += ch;
<span class="lineno" id=line93></span>              mode = dquote;
<span class="lineno" id=line94></span>            | #drop-dquote =&gt;
<span class="lineno" id=line95></span>              mode = dquote;
<span class="lineno" id=line96></span>            <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line97></span>          <span class="small_keyword" title="conditional">elif</span> ch == <span class="library" title="binding of C char type">char</span> <span class="fstring">'\\'</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line98></span>            <span class="small_keyword" title="match statement or expression">match</span> action.escape <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line99></span>            | #ignore-escape =&gt; 
<span class="lineno" id=line100></span>              current += ch;
<span class="lineno" id=line101></span>            | #keep-escape =&gt;
<span class="lineno" id=line102></span>              current += ch;
<span class="lineno" id=line103></span>              mode = escape-copying;
<span class="lineno" id=line104></span>            | #drop-escape =&gt;
<span class="lineno" id=line105></span>              mode = escape-copying;
<span class="lineno" id=line106></span>            <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line107></span>          <span class="small_keyword" title="conditional">elif</span> ord ch &lt;= <span class="fstring">' '</span>.<span class="library" title="binding of C char type">char</span>.ord  <span class="small_keyword" title="imperative code begins">do</span> <span class="comment">// can't happen if called from skipping</span>
<span class="lineno" id=line108></span>            <span class="small_keyword" title="value of function return used in post condition">result</span> += current;
<span class="lineno" id=line109></span>            current = <span class="fstring">""</span>;
<span class="lineno" id=line110></span>            mode = skipping;
<span class="lineno" id=line111></span>          <span class="small_keyword" title="conditional">else</span>
<span class="lineno" id=line112></span>            current += ch;
<span class="lineno" id=line113></span>            mode = copying;
<span class="lineno" id=line114></span>          <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line115></span>        }
<span class="lineno" id=line116></span>  
<span class="lineno" id=line117></span>        <span class="small_keyword" title="for loop">for</span> ch <span class="small_keyword" title="membership operator, function mem">in</span> s <span class="small_keyword" title="imperative code begins">do</span> 
<span class="lineno" id=line118></span>          <span class="small_keyword" title="match statement or expression">match</span> mode <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line119></span>          | #copying =&gt; handlecopying ch;
<span class="lineno" id=line120></span>          | #quote =&gt;
<span class="lineno" id=line121></span>            <span class="small_keyword" title="conditional">if</span> ch == <span class="library" title="binding of C char type">char</span> <span class="fstring">"'"</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line122></span>              <span class="small_keyword" title="match statement or expression">match</span> action.quote <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line123></span>              | #ignore-quote =&gt; 
<span class="lineno" id=line124></span>                <span class="big_keyword" title="Run time assertion">assert</span> <span class="library" title="false value">false</span>;
<span class="lineno" id=line125></span>                <span class="comment">//current += ch;</span>
<span class="lineno" id=line126></span>              | #keep-quote =&gt;
<span class="lineno" id=line127></span>                current += ch;
<span class="lineno" id=line128></span>                mode = copying;
<span class="lineno" id=line129></span>              | #drop-quote =&gt;
<span class="lineno" id=line130></span>                mode = copying;
<span class="lineno" id=line131></span>              <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line132></span>            <span class="small_keyword" title="conditional">elif</span> ch == <span class="library" title="binding of C char type">char</span> <span class="fstring">"\\"</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line133></span>              <span class="small_keyword" title="match statement or expression">match</span> action.escape <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line134></span>              | #ignore-escape =&gt; 
<span class="lineno" id=line135></span>                current += ch;
<span class="lineno" id=line136></span>              | #keep-escape =&gt;
<span class="lineno" id=line137></span>                current += ch;
<span class="lineno" id=line138></span>                mode = escape-quote;
<span class="lineno" id=line139></span>              | #drop-escape =&gt;
<span class="lineno" id=line140></span>                mode = escape-quote;
<span class="lineno" id=line141></span>              <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line142></span>            <span class="small_keyword" title="conditional">else</span>
<span class="lineno" id=line143></span>              current += ch;
<span class="lineno" id=line144></span>            <span class="small_keyword" title="end of body">done</span> 
<span class="lineno" id=line145></span>  
<span class="lineno" id=line146></span>          | #dquote =&gt;
<span class="lineno" id=line147></span>            <span class="small_keyword" title="conditional">if</span> ch == <span class="library" title="binding of C char type">char</span> <span class="fstring">'"'</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line148></span>              <span class="small_keyword" title="match statement or expression">match</span> action.dquote <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line149></span>              | #ignore-dquote =&gt; 
<span class="lineno" id=line150></span>                <span class="big_keyword" title="Run time assertion">assert</span> <span class="library" title="false value">false</span>;
<span class="lineno" id=line151></span>                <span class="comment">//current += ch;</span>
<span class="lineno" id=line152></span>              | #keep-dquote =&gt;
<span class="lineno" id=line153></span>                current += ch;
<span class="lineno" id=line154></span>                mode = copying;
<span class="lineno" id=line155></span>              | #drop-dquote =&gt;
<span class="lineno" id=line156></span>                mode = copying;
<span class="lineno" id=line157></span>              <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line158></span>            <span class="small_keyword" title="conditional">elif</span> ch == <span class="library" title="binding of C char type">char</span> <span class="fstring">"\\"</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line159></span>              <span class="small_keyword" title="match statement or expression">match</span> action.escape <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line160></span>              | #ignore-escape =&gt; 
<span class="lineno" id=line161></span>                current += ch;
<span class="lineno" id=line162></span>              | #keep-escape =&gt;
<span class="lineno" id=line163></span>                current += ch;
<span class="lineno" id=line164></span>                mode = escape-dquote;
<span class="lineno" id=line165></span>              | #drop-escape =&gt;
<span class="lineno" id=line166></span>                mode = escape-dquote;
<span class="lineno" id=line167></span>              <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line168></span>            <span class="small_keyword" title="conditional">else</span>
<span class="lineno" id=line169></span>              current += ch;
<span class="lineno" id=line170></span>            <span class="small_keyword" title="end of body">done</span> 
<span class="lineno" id=line171></span>  
<span class="lineno" id=line172></span>          | #escape-copying =&gt;
<span class="lineno" id=line173></span>             current += ch;
<span class="lineno" id=line174></span>             mode = copying;
<span class="lineno" id=line175></span>  
<span class="lineno" id=line176></span>          | #escape-quote =&gt;
<span class="lineno" id=line177></span>             current += ch;
<span class="lineno" id=line178></span>             mode = quote;
<span class="lineno" id=line179></span>  
<span class="lineno" id=line180></span>          | #escape-dquote =&gt;
<span class="lineno" id=line181></span>             current += ch;
<span class="lineno" id=line182></span>             mode = dquote;
<span class="lineno" id=line183></span>  
<span class="lineno" id=line184></span>          | #skipping =&gt;
<span class="lineno" id=line185></span>            <span class="small_keyword" title="conditional">if</span> ord ch &gt; <span class="fstring">' '</span>.<span class="library" title="binding of C char type">char</span>.ord  <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line186></span>              handlecopying ch;
<span class="lineno" id=line187></span>            <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line188></span>          <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line189></span>        <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line190></span>        <span class="small_keyword" title="return">return</span> (mode=mode, current=current, parsed=state.parsed + <span class="small_keyword" title="value of function return used in post condition">result</span>);
<span class="lineno" id=line191></span>      }
<span class="lineno" id=line192></span>    }
<span class="lineno" id=line193></span>    
<span class="lineno" id=line194></span>    <span class="comment">// simplified one shot parser.</span>
<span class="lineno" id=line195></span>    <span class="comment">// ignores mismatched quotes and backslashes.</span>
<span class="lineno" id=line196></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> respectful_split (action:RespectfulParser::action_t) (s:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>] = 
<span class="lineno" id=line197></span>    {
<span class="lineno" id=line198></span>      <span class="big_keyword" title="Define a mutable variable">var</span> state = RespectfulParser::respectful_parse
<span class="lineno" id=line199></span>        action 
<span class="lineno" id=line200></span>        (
<span class="lineno" id=line201></span>          mode=RespectfulParser::skipping, 
<span class="lineno" id=line202></span>          current=<span class="fstring">""</span>, 
<span class="lineno" id=line203></span>          parsed=Empty[<span class="library" title="binding of C++ string type">string</span>]
<span class="lineno" id=line204></span>        ) 
<span class="lineno" id=line205></span>        s
<span class="lineno" id=line206></span>      ;
<span class="lineno" id=line207></span>      <span class="comment">// ignore mismatched quotes and backslashes.</span>
<span class="lineno" id=line208></span>      <span class="small_keyword" title="match statement or expression">match</span> state.mode <span class="small_keyword" title="type-class constraint">with</span> 
<span class="lineno" id=line209></span>      | #skipping =&gt; ;
<span class="lineno" id=line210></span>      | _ =&gt; &amp;state.parsed &lt;- state.parsed + state.current;
<span class="lineno" id=line211></span>      <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line212></span>      <span class="small_keyword" title="return">return</span> state.parsed;
<span class="lineno" id=line213></span>   
<span class="lineno" id=line214></span>    }
<span class="lineno" id=line215></span>  
<span class="lineno" id=line216></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> respectful_split (s:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span>] =&gt;
<span class="lineno" id=line217></span>      respectful_split (
<span class="lineno" id=line218></span>        quote=RespectfulParser::keep-quote, 
<span class="lineno" id=line219></span>        dquote=RespectfulParser::keep-dquote, 
<span class="lineno" id=line220></span>        escape=RespectfulParser::keep-escape
<span class="lineno" id=line221></span>      ) 
<span class="lineno" id=line222></span>      s
<span class="lineno" id=line223></span>    ; 
<span class="lineno" id=line224></span>  
<span class="lineno" id=line225></span>    <span class="comment">// OO version of the parser.</span>
<span class="lineno" id=line226></span>    <span class="big_keyword" title="define an object factory">object</span> respectfulParser (action:RespectfulParser::action_t) = {
<span class="lineno" id=line227></span>      <span class="big_keyword" title="Define a mutable variable">var</span> state = (mode=RespectfulParser::skipping, current=<span class="fstring">""</span>, parsed=Empty[<span class="library" title="binding of C++ string type">string</span>]);
<span class="lineno" id=line228></span>      <span class="qualifier" title="A function depending only on its parameters">method</span> <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span> parse (s:<span class="library" title="binding of C++ string type">string</span>) {
<span class="lineno" id=line229></span>        state = RespectfulParser::respectful_parse action state s;
<span class="lineno" id=line230></span>      }
<span class="lineno" id=line231></span>      <span class="qualifier" title="A function depending only on its parameters">method</span> <span class="big_keyword" title="Define a function with no side-effects">fun</span> get_parsed () =&gt; state.parsed;
<span class="lineno" id=line232></span>    }
<span class="lineno" id=line233></span>  
</pre></p></div><h2 id='erase,_insert_or_replace_substrings_h'><img src='/share/src/web/images/minus.gif' id='erase, insert or replace substrings' onclick='toggle(this,"erase,_insert_or_replace_substrings_d")' alt='+'/> 2.20 erase, insert or replace substrings</h2><div id='erase,_insert_or_replace_substrings_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="comment">// Note: pos, length!</span>
<span class="lineno" id=line2></span>    <span class="doccomment">mutators</span>
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span> erase: &amp;<span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C size_t type">size</span> = <span class="fstring">"$1-&gt;erase($2,$3);"</span>;
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span> insert: &amp;<span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1-&gt;insert($2,$3);"</span>;
<span class="lineno" id=line5></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span> replace: &amp;<span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"$1-&gt;replace($2,$3,$4);"</span>;
<span class="lineno" id=line6></span>  
<span class="lineno" id=line7></span>    <span class="doccomment">functional</span>
<span class="lineno" id=line8></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> erase: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C size_t type">size</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"::std::string($1).erase($2,$3)"</span>;
<span class="lineno" id=line9></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> insert: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"::std::string($1).insert($2,$3)"</span>;
<span class="lineno" id=line10></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> replace: <span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C size_t type">size</span> * <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">"::std::string($1).replace($2,$3,$4)"</span>;
<span class="lineno" id=line11></span>  
<span class="lineno" id=line12></span>  
</pre></p></div><h2 id='search_and_replace_h'><img src='/share/src/web/images/minus.gif' id='search and replace' onclick='toggle(this,"search_and_replace_d")' alt='+'/> 2.21 search and replace</h2><div id='search_and_replace_d' style='display:block'>
<p>Search and replace by string.
</p><pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> search_and_replace (x:<span class="library" title="binding of C++ string type">string</span>, <span class="big_keyword" title="Define a mutable variable">var</span> spos:<span class="library" title="binding of C size_t type">size</span>, s:<span class="library" title="binding of C++ string type">string</span>, r:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line2></span>    {
<span class="lineno" id=line3></span>      <span class="big_keyword" title="Define an immutable value">val</span> m = s.<span class="library" title="number of elements in data structure">len</span>;
<span class="lineno" id=line4></span>      <span class="big_keyword" title="Define a mutable variable">var</span> o = x.[<span class="small_keyword" title="substring range separator">to</span> spos];
<span class="lineno" id=line5></span>      <span class="big_keyword" title="Define a mutable variable">var</span> n = (x,s,spos).stl_find;
<span class="lineno" id=line6></span>      <span class="small_keyword" title="while loop">while</span> n != stl_npos <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line7></span>        o+=x.[spos <span class="small_keyword" title="substring range separator">to</span> n]+r;
<span class="lineno" id=line8></span>        spos = n+m;
<span class="lineno" id=line9></span>        n = (x,s,spos).stl_find.<span class="library" title="binding of C size_t type">size</span>;
<span class="lineno" id=line10></span>      <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line11></span>      o+=x.[spos <span class="small_keyword" title="substring range separator">to</span>];
<span class="lineno" id=line12></span>      <span class="small_keyword" title="return">return</span> o;
<span class="lineno" id=line13></span>    }
<span class="lineno" id=line14></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> search_and_replace (x:<span class="library" title="binding of C++ string type">string</span>, s:<span class="library" title="binding of C++ string type">string</span>, r:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt; search_and_replace (x,0uz,s,r);
<span class="lineno" id=line15></span>  
<span class="lineno" id=line16></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> search_and_replace (vs:<span class="library" title="functional, singly linked list">list</span>[<span class="library" title="binding of C++ string type">string</span> * <span class="library" title="binding of C++ string type">string</span>]) (<span class="big_keyword" title="Define a mutable variable">var</span> v:<span class="library" title="binding of C++ string type">string</span>) = {
<span class="lineno" id=line17></span>      <span class="small_keyword" title="match statement or expression">match</span> k,b <span class="small_keyword" title="membership operator, function mem">in</span> vs <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line18></span>        v = search_and_replace (v,k,b);
<span class="lineno" id=line19></span>      <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line20></span>      <span class="small_keyword" title="return">return</span> v;
<span class="lineno" id=line21></span>    }
<span class="lineno" id=line22></span>  
</pre></p></div><h2 id='Regexp_search_and_replace_h'><img src='/share/src/web/images/minus.gif' id='Regexp search and replace' onclick='toggle(this,"Regexp_search_and_replace_d")' alt='+'/> 2.22 Regexp search and replace</h2><div id='Regexp_search_and_replace_d' style='display:block'>
<p>Uses Google RE2 engine.
</p><pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="comment">// Replace \0 \1 \2 etc in s with text from v</span>
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> subst(s:<span class="library" title="binding of C++ string type">string</span>, v:<span class="library" title="array with dynamically variable limit up to a fixed bound">varray</span>[StringPiece]): <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line3></span>    {
<span class="lineno" id=line4></span>    <span class="comment">//println$ "Subst " + s +" with " + str v;</span>
<span class="lineno" id=line5></span>       <span class="big_keyword" title="Elaborate an enumeration, a simple sum type">enum</span> mode_t {cp, ins};
<span class="lineno" id=line6></span>       <span class="big_keyword" title="Define a mutable variable">var</span> b = <span class="fstring">""</span>;
<span class="lineno" id=line7></span>       <span class="big_keyword" title="Define a mutable variable">var</span> mode=cp;
<span class="lineno" id=line8></span>       <span class="big_keyword" title="Define a mutable variable">var</span> j = 0;
<span class="lineno" id=line9></span>       <span class="big_keyword" title="Define a mutable variable">var</span> count = 0;
<span class="lineno" id=line10></span>       <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> i <span class="small_keyword" title="membership operator, function mem">in</span> 0 <span class="small_keyword" title="upwards counting for loop">upto</span> s.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> - 1 <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line11></span>         <span class="small_keyword" title="match statement or expression">match</span> mode <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line12></span>         | #cp =&gt; 
<span class="lineno" id=line13></span>           <span class="small_keyword" title="conditional">if</span> s.[i] == <span class="library" title="binding of C char type">char</span> <span class="fstring">"\\"</span> <span class="small_keyword" title="imperative code begins">do</span> 
<span class="lineno" id=line14></span>             mode = ins; 
<span class="lineno" id=line15></span>             j=0; count = 0; 
<span class="lineno" id=line16></span>           <span class="small_keyword" title="conditional">else</span> 
<span class="lineno" id=line17></span>            b += s.[i]; 
<span class="lineno" id=line18></span>           <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line19></span>         | #ins =&gt;
<span class="lineno" id=line20></span>           <span class="small_keyword" title="conditional">if</span> s.[i] <span class="small_keyword" title="membership operator, function mem">in</span> <span class="fstring">"0123456789"</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line21></span>             j = j * 10 + ord(s.[i]) - ord (<span class="library" title="binding of C char type">char</span> <span class="fstring">"0"</span>);
<span class="lineno" id=line22></span>             ++count;
<span class="lineno" id=line23></span>           <span class="small_keyword" title="conditional">else</span>
<span class="lineno" id=line24></span>             <span class="small_keyword" title="conditional">if</span> count == 0 <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line25></span>               b += <span class="fstring">"\\"</span>;
<span class="lineno" id=line26></span>             <span class="small_keyword" title="conditional">elif</span> j &lt; v.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line27></span>               b+= <span class="library" title="Convert a value to a string">str</span> v.stl_begin.j;
<span class="lineno" id=line28></span>             <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line29></span>             <span class="comment">// adjacent insertion?</span>
<span class="lineno" id=line30></span>             <span class="small_keyword" title="conditional">if</span> s.[i] == <span class="library" title="binding of C char type">char</span> <span class="fstring">"\\"</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line31></span>               j=0; count=0;
<span class="lineno" id=line32></span>             <span class="small_keyword" title="conditional">else</span>
<span class="lineno" id=line33></span>               mode = cp;
<span class="lineno" id=line34></span>               b += s.[i]; 
<span class="lineno" id=line35></span>             <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line36></span>           <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line37></span>         <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line38></span>       <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line39></span>       <span class="comment">// run off end</span>
<span class="lineno" id=line40></span>       <span class="small_keyword" title="match statement or expression">match</span> mode <span class="small_keyword" title="type-class constraint">with</span>
<span class="lineno" id=line41></span>       | #cp =&gt; ;
<span class="lineno" id=line42></span>       | #ins =&gt;
<span class="lineno" id=line43></span>         <span class="small_keyword" title="conditional">if</span> count == 0 <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line44></span>           b += <span class="fstring">"\\"</span>;
<span class="lineno" id=line45></span>         <span class="small_keyword" title="conditional">elif</span> j &lt; v.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span> <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line46></span>           b+= <span class="library" title="Convert a value to a string">str</span> v.j;
<span class="lineno" id=line47></span>         <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line48></span>       <span class="small_keyword" title="end a match statement or expression">endmatch</span>;
<span class="lineno" id=line49></span>       <span class="small_keyword" title="return">return</span> b;
<span class="lineno" id=line50></span>    }
<span class="lineno" id=line51></span>    <span class="comment">// Search for regex, replace by r with \0 \1 \2 etc replace by match groups.</span>
<span class="lineno" id=line52></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> search_and_replace (x:<span class="library" title="binding of C++ string type">string</span>, <span class="big_keyword" title="Define a mutable variable">var</span> spos: <span class="library" title="binding of C size_t type">size</span>, re:Re2::RE2, r:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line53></span>    {
<span class="lineno" id=line54></span>      <span class="big_keyword" title="Define a mutable variable">var</span> ngroups = re.NumberOfCapturingGroups + 1;
<span class="lineno" id=line55></span>      <span class="big_keyword" title="Define a mutable variable">var</span> v = <span class="library" title="array with dynamically variable limit up to a fixed bound">varray</span>[StringPiece]$ (ngroups+1).<span class="library" title="binding of C size_t type">size</span>, StringPiece <span class="fstring">""</span>;
<span class="lineno" id=line56></span>      <span class="big_keyword" title="Define a mutable variable">var</span> o = x.[<span class="small_keyword" title="substring range separator">to</span> spos];             <span class="comment">// initial substring</span>
<span class="lineno" id=line57></span>      <span class="big_keyword" title="Define a mutable variable">var</span> sp = StringPiece(x);
<span class="lineno" id=line58></span>      <span class="big_keyword" title="Define a mutable variable">var</span> base : +<span class="library" title="binding of C char type">char</span> = sp.data;      <span class="comment">// base pointer of char array</span>
<span class="lineno" id=line59></span>      <span class="small_keyword" title="while loop">while</span> Re2::Match(re, sp, spos.<span class="library" title="binding of C int type">int</span>, UNANCHORED, v.stl_begin, v.<span class="library" title="number of elements in data structure">len</span>.<span class="library" title="binding of C int type">int</span>) <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line60></span>        <span class="big_keyword" title="Define a mutable variable">var</span> mpos = <span class="library" title="binding of C size_t type">size</span>(v.0.data - base);  <span class="comment">// start of match</span>
<span class="lineno" id=line61></span>        o+= x.[spos <span class="small_keyword" title="substring range separator">to</span> mpos];          <span class="comment">// copy upto start of match</span>
<span class="lineno" id=line62></span>        o+= subst(r,v);                <span class="comment">// copy replacement</span>
<span class="lineno" id=line63></span>        spos = mpos + v.0.<span class="library" title="number of elements in data structure">len</span>;       <span class="comment">// advance over match</span>
<span class="lineno" id=line64></span>      <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line65></span>      o+=x.[spos <span class="small_keyword" title="substring range separator">to</span>];                  <span class="comment">// rest of string</span>
<span class="lineno" id=line66></span>      <span class="small_keyword" title="return">return</span> o;
<span class="lineno" id=line67></span>    }
</pre></p></div><h2 id='Parse_string_to_numeric_type_h'><img src='/share/src/web/images/minus.gif' id='Parse string to numeric type' onclick='toggle(this,"Parse_string_to_numeric_type_d")' alt='+'/> 2.23 Parse string to numeric type</h2><div id='Parse_string_to_numeric_type_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> atoi: <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C int type">int</span> = <span class="fstring">"::std::atoi($1:postfix.c_str())"</span>  <span class="big_keyword" title="specify requirements">requires</span> Cxx_headers::cstdlib;
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> atol: <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C long type">long</span> = <span class="fstring">"::std::atol($1:postfix.c_str())"</span>  <span class="big_keyword" title="specify requirements">requires</span> Cxx_headers::cstdlib;
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> atoll: <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C long type">long</span> = <span class="fstring">"::std::atoll($1:postfix.c_str())"</span>  <span class="big_keyword" title="specify requirements">requires</span> Cxx_headers::cstdlib;
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> atof: <span class="library" title="binding of C++ string type">string</span> -&gt; <span class="library" title="binding of C double float type">double</span> = <span class="fstring">"::std::atof($1:postfix.c_str())"</span>  <span class="big_keyword" title="specify requirements">requires</span> Cxx_headers::cstdlib;
<span class="lineno" id=line5></span>  
</pre></p></div><h2 id='Reserve_store_h'><img src='/share/src/web/images/minus.gif' id='Reserve store' onclick='toggle(this,"Reserve_store_d")' alt='+'/> 2.24 Reserve store</h2><div id='Reserve_store_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a procedure, a function with side-effects not returning a value">proc</span> reserve: &amp;<span class="library" title="binding of C++ string type">string</span> * !ints = <span class="fstring">"$1-&gt;reserve($2);"</span>;
<span class="lineno" id=line2></span>  
</pre></p></div><h2 id='Fetch_underlying_cstring._h'><img src='/share/src/web/images/minus.gif' id='Fetch underlying cstring.' onclick='toggle(this,"Fetch_underlying_cstring._d")' alt='+'/> 2.25 Fetch underlying cstring.</h2><div id='Fetch_underlying_cstring._d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="comment">// safely returns a malloc()'d copy, not garbage collected </span>
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> _unsafe_cstr: <span class="library" title="binding of C++ string type">string</span> -&gt; +<span class="library" title="binding of C char type">char</span> = <span class="fstring">"::flx::rtl::strutil::flx_cstr($1)"</span> is atom;
<span class="lineno" id=line3></span>  
<span class="lineno" id=line4></span>    <span class="comment">// partially unsafe because the string could be modified.</span>
<span class="lineno" id=line5></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_begin: &amp;<span class="library" title="binding of C++ string type">string</span> -&gt; +<span class="library" title="binding of C char type">char</span> = <span class="fstring">"((char*)$1-&gt;c_str())"</span> is atom;
<span class="lineno" id=line6></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> stl_end: &amp;<span class="library" title="binding of C++ string type">string</span> -&gt; +<span class="library" title="binding of C char type">char</span> = <span class="fstring">"((char*)($1-&gt;c_str()+$1-&gt;size()))"</span> is atom;
<span class="lineno" id=line7></span>  
<span class="lineno" id=line8></span>    <span class="comment">// this operation returns a char pointer to GC managed storage</span>
<span class="lineno" id=line9></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> cstr (<span class="big_keyword" title="Define a mutable variable">var</span> s:<span class="library" title="binding of C++ string type">string</span>) =&gt; s.<span class="library" title="array with dynamically variable limit up to a fixed bound">varray</span>[<span class="library" title="binding of C char type">char</span>].stl_begin;
<span class="lineno" id=line10></span>  
</pre></p></div><h2 id='Polymorphic_vsprintf_hack_h'><img src='/share/src/web/images/minus.gif' id='Polymorphic vsprintf hack' onclick='toggle(this,"Polymorphic_vsprintf_hack_d")' alt='+'/> 2.26 Polymorphic vsprintf hack</h2><div id='Polymorphic_vsprintf_hack_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> vsprintf[t]: +<span class="library" title="binding of C char type">char</span>  * t -&gt; <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line2></span>      <span class="fstring">"::flx::rtl::strutil::flx_asprintf($1,$2)"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>
<span class="lineno" id=line3></span>    ;
<span class="lineno" id=line4></span>  
<span class="lineno" id=line5></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> vsprintf[t]: <span class="library" title="binding of C++ string type">string</span> * t -&gt; <span class="library" title="binding of C++ string type">string</span> =
<span class="lineno" id=line6></span>      <span class="fstring">"::flx::rtl::strutil::flx_asprintf(const_cast&lt;char*&gt;($1.c_str()),$2)"</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>
<span class="lineno" id=line7></span>    ;
<span class="lineno" id=line8></span>  
</pre></p></div><h2 id='Case_translation_h'><img src='/share/src/web/images/minus.gif' id='Case translation' onclick='toggle(this,"Case_translation_d")' alt='+'/> 2.27 Case translation</h2><div id='Case_translation_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>    <span class="comment">// Convert all characters to upper case  </span>
<span class="lineno" id=line2></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> toupper(s:<span class="library" title="binding of C++ string type">string</span>):<span class="library" title="binding of C++ string type">string</span> =&gt; <span class="library" title="return data structure with function applied to each value">map</span> (toupper of <span class="library" title="binding of C char type">char</span>) s;
<span class="lineno" id=line3></span>    <span class="comment">// Convert all characters to lower case</span>
<span class="lineno" id=line4></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> tolower(s:<span class="library" title="binding of C++ string type">string</span>):<span class="library" title="binding of C++ string type">string</span> =&gt; <span class="library" title="return data structure with function applied to each value">map</span> (tolower of <span class="library" title="binding of C char type">char</span>) s;
<span class="lineno" id=line5></span>  }
<span class="lineno" id=line6></span>  
<span class="lineno" id=line7></span>  
</pre></p></div><h2 id='Transation_to_string_h'><img src='/share/src/web/images/minus.gif' id='Transation to string' onclick='toggle(this,"Transation_to_string_d")' alt='+'/> 2.28 Transation to string</h2><div id='Transation_to_string_d' style='display:block'>
<pre class='inclusion'>
share/lib/std/strings/string.flx</pre>
<p><pre class='flxbg'><span class="lineno" id=line1></span>  
<span class="lineno" id=line2></span>  <span class="big_keyword" title="Provide an instance of a typeclass">instance</span> Str[<span class="library" title="binding of C++ string type">string</span>] {
<span class="lineno" id=line3></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> <span class="library" title="Convert a value to a string">str</span> (s:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> =&gt; s;
<span class="lineno" id=line4></span>  }
<span class="lineno" id=line5></span>  
<span class="lineno" id=line6></span>  <span class="big_keyword" title="Provide an instance of a typeclass">instance</span> Str[+<span class="library" title="binding of C char type">char</span>] {
<span class="lineno" id=line7></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> <span class="library" title="Convert a value to a string">str</span>: +<span class="library" title="binding of C char type">char</span> -&gt; <span class="library" title="binding of C++ string type">string</span> = <span class="fstring">'::flx::rtl::strutil::atostr($1)'</span> <span class="big_keyword" title="specify requirements">requires</span> <span class="small_keyword" title="specifies an abstract package name">package</span> <span class="fstring">"flx_strutil"</span>;
<span class="lineno" id=line8></span>  }
<span class="lineno" id=line9></span>  
<span class="lineno" id=line10></span>  <span class="big_keyword" title="Provide an instance of a typeclass">instance</span> Repr[<span class="library" title="binding of C++ string type">string</span>] {
<span class="lineno" id=line11></span>    <span class="big_keyword" title="Define a function with no side-effects">fun</span> repr (x:<span class="library" title="binding of C++ string type">string</span>) : <span class="library" title="binding of C++ string type">string</span> = {
<span class="lineno" id=line12></span>      <span class="big_keyword" title="Define a mutable variable">var</span> o = <span class="fstring">"'"</span>;
<span class="lineno" id=line13></span>      <span class="small_keyword" title="conditional">if</span> <span class="library" title="number of elements in data structure">len</span> x &gt; 0uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line14></span>        <span class="small_keyword" title="for loop">for</span> <span class="big_keyword" title="Define a mutable variable">var</span> i <span class="small_keyword" title="membership operator, function mem">in</span> 0uz <span class="small_keyword" title="upwards counting for loop">upto</span> (String::<span class="library" title="number of elements in data structure">len</span> x) - 1uz <span class="small_keyword" title="imperative code begins">do</span>
<span class="lineno" id=line15></span>          o += repr x.[i];
<span class="lineno" id=line16></span>        <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line17></span>      <span class="small_keyword" title="end of body">done</span>
<span class="lineno" id=line18></span>      <span class="small_keyword" title="return">return</span> o + <span class="fstring">"'"</span>;
<span class="lineno" id=line19></span>    }
<span class="lineno" id=line20></span>  }
<span class="lineno" id=line21></span>  
<span class="lineno" id=line22></span>  <span class="big_keyword" title="Open a module or class">open</span>[T <span class="small_keyword" title="membership operator, function mem">in</span> strings] Show[T];
<span class="lineno" id=line23></span>  <span class="big_keyword" title="Open a module or class">open</span> Set[<span class="library" title="binding of C++ string type">string</span>,<span class="library" title="binding of C char type">char</span>];
<span class="lineno" id=line24></span>  
<span class="lineno" id=line25></span>  
</pre></p></div></div><!--Main Content Body End-->

          </div> <!-- rightpanel contents end -->
          <hr>
        </span> <!-- rightpanel end -->

        <span id="panemover" style="cursor:col-resize;"
         onmousedown="dragStart(event, 'left', 'right'); return false;"
         onmousemove="drag(event, 'left', 'right');"
         onmouseout="dragRelease();"
         onmouseup="dragRelease();"
        >
        </span> <!-- panemover end -->
      </div> <!-- bottom panel end -->
    </div> <!-- container end -->
</body></html>

